{"version":3,"file":"jquery.send.form.min.js","sources":["jquery.send.form.js"],"names":["$","fn","aSendForm","params","this","each","merge_options","obj1","obj2","obj3","attrname","s","extend","answer","popup","popupObj","onClickPopup","goal","postQuery","closeData","dataClass","associations","mailTo","onSend","moreData","bitrix","TITLE","validateRuls","thisForm","onClose","tmpFun","aCallBack","setTimeout","error","bPopup","popups","split","bind","apply","console","warn","validate","validateOption","errorElement","errorPlacement","element","css","after","addClass","replace","next","outerWidth","parseFloat","fadeIn","fadeOut","height","focus","focusout","success","label","prev","box-shadow","border-color","remove","validator","addMethod","value","regexp","re","RegExp","optional","test","find","keypress","e","which","form","submit","input","serializeForm","serializeArray","i","length","name","attr","val","art_post_pagetitle","document","title","art_mail_to","art_bitrix","push","artsDataF","data","post","done","close","styleDiv","styleH2","append","autoClose","follow","position","jQuery"],"mappings":"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","sourcesContent":["/* \r\n\tCreated by Art Sites Studio\r\n\tSite: art-sites.org\r\n\tVersion: 1.8\r\n\tMore bitrix inputs https://dev.1c-bitrix.ru/community/blogs/chaos/crm-sozdanie-lidov-iz-drugikh-servisov.php\r\n*/\r\n(function( $ ) {\r\n\r\n\r\n\r\n\r\n\t$.fn.aSendForm = function(params){\r\n\t\t$(this).each(function(){\r\n\t\t\tvar s = $.extend({\r\n\t\t\t\tanswer : false, \t\t\t\t// Ответ от сервера, если не указать он будет стандартным, или можно указать jq object\r\n\t\t\t\tpopup : false, \t\t\t\t\t// Является ли форма всплывающим окном, если да то нужно указать два параметра через кому в виде селекторов jquery \".кнопка , .селектор_блокаформы\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t// *Обязательно нужен плагин bPopup\r\n\t\t\t\tpopupObj : {}, \t\t\t\t\t// Объект который передаётся в плагин bPopup\r\n\t\t\t\tonClickPopup : false, \t\t\t// Функция которая срабатывает во время нажатия кнопки всплывающего окна\r\n\t\t\t\tgoal : false, \t\t\t\t\t// Цели, для аналитики\r\n\t\t\t\tpostQuery: '/handle.php', \t\t// Путь к файлу handle.php\r\n\t\t\t\tcloseData: 1000, \t\t\t\t// Время закрытия окна с ответом\r\n\t\t\t\tdataClass: 'amassage_popup', \t// Класс окна с ответом\r\n\t\t\t\tassociations : null, \t\t\t// Объект который ассоциируется с атрибутом name=\"\" в полей формы Например {'name':'Имя', 'phone':'Номер телефона'}\r\n\t\t\t\tmailTo : false, \t\t\t\t// Обязательный параметр, E-mail для отправки формы\r\n\t\t\t\tonSend : false, \t\t\t\t// Событие которое срабатывает во время отправки данных\r\n\t\t\t\tmoreData : false,\t\t\t\t// дополнительный параметр для дополнительных данных формы\r\n\t\t\t\tbitrix : { \t\t\t\t\t\t// Параметры для полей битрикса, обязательно нужно заполнить доступа к битриксу в файле handle.php\r\n\t\t\t\t\t'TITLE' : false\r\n\t\t\t\t},\r\n\t\t\t\tvalidateRuls: false\t\t\t\t// Правила и сообщения для валидации\r\n\r\n\t\t\t}, params);\r\n\t\t\tvar thisForm = $(this);\r\n\t\t\tif (typeof s.popupObj.onClose == 'function') {\r\n\t\t\t\tvar tmpFun = s.popupObj.onClose;\r\n\t\t\t\ts.popupObj.onClose = function(){\r\n\t\t\t\t\ttmpFun();\r\n\t\t\t\t\tif (typeof $.aCallBack == 'function') {setTimeout(function(){$.aCallBack('tada')},30000);};\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\ts.popupObj.onClose = function(){\r\n\t\t\t\t\tif (typeof $.aCallBack == 'function') {setTimeout(function(){$.aCallBack('tada')},30000);};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\tif (!s.mailTo) { $.error( 'Нужно ввести Ваш E-mail');};\r\n\t\t\t\tif (s.popup) {\r\n\t\t\t\t\tif (typeof $.fn.bPopup == 'function') {\r\n\t\t\t\t\t\tvar popups = s.popup.split(',');\r\n\t\t\t\t\t\t$(popups[0]).bind('click',function(){\r\n\r\n\t\t\t\t\t\t\tif (typeof s.onClickPopup == 'function') {s.onClickPopup.apply(this)};\r\n\t\t\t\t\t\t\t$(popups[1]).bPopup(s.popupObj);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\ts.popup = false;\r\n\t\t\t\t\t\tconsole.warn('Plugin bPopup is not defined, popups is not work');\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t/*\r\n\t\t\t\tValidation realisation\r\n\t\t\t*/\r\n\r\n\t\t\t\tfunction merge_options(obj1,obj2){\r\n\t\t\t\t    var obj3 = {};\r\n\t\t\t\t    for (var attrname in obj1) { obj3[attrname] = obj1[attrname]; }\r\n\t\t\t\t    for (var attrname in obj2) { obj3[attrname] = obj2[attrname]; }\r\n\t\t\t\t    return obj3;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (s.validateRuls) {\r\n\t\t\t\t\tif (typeof $.fn.validate == 'function') {\r\n\t\t\t\t\t\tvar validateOption = {\r\n\t\t\t\t\t\t\terrorElement: 'div', //default input error message container\r\n\t\t\t\t\t\t\terrorPlacement: function(error,element){\r\n\t\t\t\t\t\t\t\t$(element).css('box-shadow','0 0 5px #ED2328');\r\n\t\t\t\t\t\t\t\t$(element).css('border-color','#ED2328');\r\n\t\t\t\t\t\t\t\t$(element).after($(error).addClass(\"a-valid-message\")\r\n\t\t\t\t\t\t\t\t\t.css('margin-top',14 - $(element).css('marginBottom').replace(/px/g,\"\") +'px')\r\n\t\t\t\t\t\t\t\t\t.css('width', $(element).next('.a-valid-message'+' > p').outerWidth()+'px')\r\n\t\t\t\t\t\t\t\t\t.css('margin-left', ($(element).outerWidth()/100)*50  + parseFloat($(element).css('marginLeft')) +'px')\r\n\t\t\t\t\t\t\t\t\t.css(\"display\",\"none\")\r\n\t\t\t\t\t\t\t\t\t.fadeIn(\"fast\",function(){\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function(){$(element).next('.a-valid-message').fadeOut(50)},2000);\r\n\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\tif ($(element).css('float') != 'none') {\r\n\t\t\t\t\t\t\t\t\t$(element).next('.a-valid-message').css('margin-top',14 + parseFloat($(element).height()) +'px')\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t$(element).focus(function(){\r\n\t\t\t\t\t\t\t\t\t$(element).next('.a-valid-message').fadeIn(\"fast\");\t\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(element).focusout(function(){\r\n\t\t\t\t\t\t\t\t\t$(element).next('.a-valid-message').fadeOut(50);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\tsuccess: function (label) {\r\n\t\t\t\t\t\t\t\tlabel.prev('input').css({\r\n\t\t\t\t\t\t\t\t\t'box-shadow':'',\r\n\t\t\t\t\t\t\t\t\t'border-color':''\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tlabel.remove();\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t$.validator.addMethod(\r\n\t\t\t\t\t        \"regex\",\r\n\t\t\t\t\t        function(value, element, regexp) {\r\n\t\t\t\t\t            var re = new RegExp(regexp);\r\n\t\t\t\t\t            return this.optional(element) || re.test(value);\r\n\t\t\t\t\t        },\r\n\t\t\t\t\t        \"Please check your input.\"\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tthisForm.validate(merge_options(validateOption, s.validateRuls));\r\n\r\n\t\t\t\t\t\tthisForm.find('input').keypress(function (e) {\r\n\t\t\t\t\t\t\tif (e.which == 13) {\r\n\t\t\t\t\t\t\t\tif (thisForm.validate().form()) {\r\n\t\t\t\t\t\t\t\t\tthisForm.submit();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tconsole.warn('Function validate is not defined, validation is not work');\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t/*\r\n\t\t\t\tValidation realisation\r\n\t\t\t*/\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t/*\r\n\t\t\t\tEvent of form send\r\n\t\t\t*/\r\n\r\n\t\t\t\tthisForm.bind('submit',function(){\r\n\t\t\t\t\t\tif (typeof $.fn.validate == 'function') {\r\n\t\t\t\t\t\t\tif (!thisForm.validate().form()) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar input = {};\r\n\r\n\t\t\t\t\tvar serializeForm = $(this).serializeArray();\r\n\t\t\t\t\tfor (var i = 0; i < serializeForm.length; i++) {\r\n\t\t\t\t\t\tif(s.associations[serializeForm[i].name]){\r\n\t\t\t\t\t\t\tinput[serializeForm[i].name] = [s.associations[serializeForm[i].name],serializeForm[i].value];\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tinput[serializeForm[i].name] = [serializeForm[i].name,serializeForm[i].value];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$(this).find('input, textarea').each(function(){\r\n\t\t\t\t\t\tif ($(this).attr('type') != 'submit') {\r\n\t\t\t\t\t\t\t$(this).val('');\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (typeof s.goal == 'function') {s.goal()};\r\n\r\n\t\t\t\t\tinput.art_post_pagetitle = document.title;\r\n\t\t\t\t\tinput.art_mail_to = s.mailTo;\r\n\t\t\t\t\tif (s.bitrix['TITLE']) {\r\n\t\t\t\t\t\tinput.art_bitrix = [];\r\n\t\t\t\t\t\tfor(var name in s.bitrix){\r\n\t\t\t\t\t\t\tif (input[s.bitrix[name]]) {\r\n\t\t\t\t\t\t\t\tinput.art_bitrix.push([name , input[s.bitrix[name]][1]]);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tinput.art_bitrix.push([name , s.bitrix[name]]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (s.moreData) {\r\n\t\t\t\t\t\tinput.artsDataF = [s.moreData.title,s.moreData.data];\r\n\t\t\t\t\t};\r\n\t\t\t\t\t$.post(s.postQuery,input).done(function(e){\r\n\t\t\t\t\t\tif (s.popup) {\r\n\t\t\t\t\t\t\t$(popups[1]).bPopup().close();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (typeof s.onSend == 'function') {s.onSend()};\r\n\t\t\t\t\t\tif (s.answer) {e = s.answer};\r\n\t\t\t\t\t\tif (typeof s.answer != 'object') {\r\n\t\t\t\t\t\t\tvar styleDiv = s.dataClass == 'amassage_popup' ? 'style = \\'background: #fff;padding: 28px 44px;width: 550px;max-width: 100%;display:none;transform: translateX(-50%);\\'' : '';\r\n\t\t\t\t\t\t\tvar styleH2 = s.dataClass == 'amassage_popup' ? 'style = \\'margin: 5px;text-align: center;font-weight: 200;font-size: 27px;\\'' : '';\r\n\t\t\t\t\t\t\t$('body').append('<div class=\"'+s.dataClass+'\" '+ styleDiv +'><h2 '+styleH2+' >'+e+'</h2></div>');\r\n\t\t\t\t\t\t\t$('.'+s.dataClass).bPopup({\r\n\t\t\t\t\t\t\t\tautoClose: s.closeData,\r\n\t\t\t\t\t\t\t\tonClose: function(){\r\n\t\t\t\t\t\t\t\t\t$('.'+s.dataClass).remove();\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfollow: [false, true],\r\n\t            \t\t\t\tposition: ['50%', 'auto'],\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\ts.answer.bPopup({\r\n\t\t\t\t\t\t\t\tautoClose: s.closeData,\r\n\t\t\t\t\t\t\t\tonClose: function(){\r\n\t\t\t\t\t\t\t\t\t$('.'+s.dataClass).remove();\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t})\r\n\r\n\t\t\t/*\r\n\t\t\t\tEvent of form send\r\n\t\t\t*/\r\n\t\t});\r\n\r\n\t\t}\r\n})(jQuery)"]}